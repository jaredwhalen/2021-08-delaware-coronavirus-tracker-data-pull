?yday()
weatherData %>%
mutate(date = as.Date(date)) %>%
mutate(year = year(date)) %>%
mutate(doy = yday(date))
weatherData %>%
mutate(date = as.Date(date)) %>%
mutate(year = year(date)) %>%
mutate(doy = yday(date)) %>%
ggplot(
aes(
x = doy,
y = prcp
)
) +
geom_line() +
facet_wrap(~year)
weatherData %>%
mutate(date = as.Date(date)) %>%
mutate(year = year(date)) %>%
mutate(doy = yday(date)) %>%
filter(year > 1992) %>%
ggplot(
aes(
x = doy,
y = prcp
)
) +
geom_line() +
facet_wrap(~year)
weatherData %>%
mutate(date = as.Date(date)) %>%
mutate(year = year(date)) %>%
mutate(doy = yday(date)) %>%
mutate(month = month(date))
weatherData %>%
mutate(date = as.Date(date)) %>%
mutate(year = year(date)) %>%
mutate(month = month(date)) %>%
group_by(year, month) %>%
summarise(total = sum(prcp, na.rm = FALSE))
weatherData %>%
mutate(date = as.Date(date)) %>%
mutate(year = year(date)) %>%
filter(year > 1992) %>%
mutate(month = month(date)) %>%
group_by(year, month) %>%
summarise(total = sum(prcp, na.rm = FALSE))
weatherData %>%
mutate(date = as.Date(date)) %>%
mutate(year = year(date)) %>%
filter(year > 1992) %>%
mutate(month = month(date)) %>%
group_by(year, month) %>%
summarise(total = sum(prcp, na.rm = FALSE)) %>%
ggplot(
aes(
x = month,
y = total
)
) +
geom_line() +
facet_wrap(~year)
weatherData %>%
mutate(date = as.Date(date)) %>%
mutate(year = year(date)) %>%
filter(year > 1992) %>%
mutate(month = month(date)) %>%
group_by(year, month) %>%
summarise(total = sum(prcp, na.rm = FALSE)) %>%
ggplot(
aes(
x = month,
y = total
)
) +
geom_bar() +
facet_wrap(~year)
weatherData %>%
mutate(date = as.Date(date)) %>%
mutate(year = year(date)) %>%
filter(year > 1992) %>%
mutate(month = month(date)) %>%
group_by(year, month) %>%
summarise(total = sum(prcp, na.rm = FALSE)) %>%
ggplot(
aes(
x = month,
y = total
)
) +
geom_col() +
facet_wrap(~year)
View(weatherData)
weatherData %>%
mutate(date = as.Date(date)) %>%
mutate(year = year(date)) %>%
filter(year > 1992) %>%
mutate(month = month(date)) %>%
group_by(year, month) %>%
summarise(total = sum(prcp, na.rm = FALSE)) %>%
View()
View(weatherData)
weatherData %>%
mutate(date = as.Date(date)) %>%
mutate(year = year(date)) %>%
filter(year > 1992) %>%
mutate(month = month(date)) %>%
group_by(year, month) %>%
summarise(total = sum(prcp, na.rm = TRUE)) %>%
View()
weatherData %>%
mutate(date = as.Date(date)) %>%
mutate(year = year(date)) %>%
filter(year > 1992) %>%
mutate(month = month(date)) %>%
group_by(year, month) %>%
summarise(total = sum(prcp, na.rm = TRUE)) %>%
ggplot(
aes(
x = month,
y = total
)
) +
geom_col() +
facet_wrap(~year)
install.packages("rnoaa")
library(rnoaa)
?rnoaa
รง
ncdc_*
browseVignettes("rnoaa")
library(rnoaa)
library(rnoaa)
browseVignettes(rnoaa)
library(rnoaa)
browseVignettes(rnoaa)
browseVignettes("rnoaa"")
browseVignettes("rnoaa")
vignette
vignette(rnoaa)
storm_
rnoaa
library(rnoaa)
devtools::install_github("ropensci/rnoaa")
install.packages("devtools")
devtools::install_github("ropensci/rnoaa")
library("rnoaa")
ncdc(datasetid = 'GHCND', stationid = 'GHCND:USW00014895', startdate = '2013-10-01',
enddate = '2013-12-01')
?rnoaa
?rnoaa
detach("package:rnoaa", unload = TRUE)
library(rnoaa)
library(rnoaa)
ncdc()
?ncdc()
library(tidyverse)
install.packages("haven")
orr.stata <- read_dta(file = "./Downloads/orr_prm_1975_2018_v1.dta")
library(tidyverse)
library(haven)
orr.stata <- read_dta(file = "./Downloads/orr_prm_1975_2018_v1.dta")
View(orr.stata)
library(janitor)
clean_names()
oor <- oor.stata %>%
clean_names()
orr <- orr.stata %>%
clean_names()
View(orr)
colnames(orr)
View(orr)
orr.stata %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
sum = sum*refugees
)
orr.stata %>%
mutate(refugees = as.numeric(refugees))
orr.stata %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
sum = sum(refugees, na.rm = T)
)
orr.stata %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
)
#Load packages
library(sp)
library(rgdal)
library(reshape)
install.packages("reshape")
install.packages("maptools")
library(reshape)
library(ggplot2)
library(maptools)
library(rgeos) #create a range standardisation function
install.packages("rgeos")
library(rgeos) #create a range standardisation function
orr.stata %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
)
orr.stata %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
# citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
)
orr.stata %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
# citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
) %>%
write_csv("Desktop/refugees.csv")
orr.stata %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
)
orr.stata %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
) %>%
pull(citizenship_stable)
orr.stata %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
) %>%
pull(citizenship_stable) %>%  distinct()
orr.stata %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
) %>%
pull(citizenship_stable) %>%unique()
library("jsonlite")
json_file <- 'https://datahub.io/JohnSnowLabs/country-and-continent-codes-list/datapackage.json'
json_data <- fromJSON(paste(readLines(json_file), collapse=""))
# get list of all resources:
print(json_data$resources$name)
# print all tabular data(if exists any)
for(i in 1:length(json_data$resources$datahub$type)){
if(json_data$resources$datahub$type[i]=='derived/csv'){
path_to_file = json_data$resources$path[i]
data <- read.csv(url(path_to_file))
print(data)
}
}
View(data)
# print all tabular data(if exists any)
for(i in 1:length(json_data$resources$datahub$type)){
if(json_data$resources$datahub$type[i]=='derived/csv'){
path_to_file = json_data$resources$path[i]
countryToContinent <- read.csv(url(path_to_file))
print(data)
}
}
orr %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
)
orr.sum <- orr %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
)
orr.sum
View(countryToContinent)
# print all tabular data(if exists any)
for(i in 1:length(json_data$resources$datahub$type)){
if(json_data$resources$datahub$type[i]=='derived/csv'){
path_to_file = json_data$resources$path[i]
countryToContinent <- read.csv(url(path_to_file)) %>%  clean_names()
print(data)
}
}
orr.sum %>%
rename(country_name = citizenship_stable) %>%
left_join(countryToContinent)
orr.sum %>%
rename(country_name = citizenship_stable)
?rename
orr.sum %>%
dplyr::rename(country_name = citizenship_stable)
orr.sum %>%
dplyr::rename(country_name = citizenship_stable) %>%
left_join(countryToContinent)
orr.sum %>%
dplyr::rename(country_name = citizenship_stable) %>%
left_join(countryToContinent) %>%
View()
countryToContinent %>%
write_csv("Desktop/countryToContinent.csv")
orr.sum <- orr %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
) %>%
write_csv("Desktop/refugees.csv")
pull(countryToContinent$country_name)
?pull
dplyr:;pull(countryToContinent$country_name)
dplyr::pull(countryToContinent$country_name)
distinct(countryToContinent$country_name)
countryToContinent$country_name
unique(countryToContinent$country_name)
pull(countryToContinent, country_name)
orr.stata <- read_dta(file = "./Downloads/orr_prm_1975_2018_v1.dta")
orr <- orr.stata %>%
clean_names()
orr.sum <- orr %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
) %>%
write_csv("Desktop/refugees.csv")
library("jsonlite")
json_file <- 'https://datahub.io/JohnSnowLabs/country-and-continent-codes-list/datapackage.json'
json_data <- fromJSON(paste(readLines(json_file), collapse=""))
# get list of all resources:
print(json_data$resources$name)
# print all tabular data(if exists any)
for(i in 1:length(json_data$resources$datahub$type)){
if(json_data$resources$datahub$type[i]=='derived/csv'){
path_to_file = json_data$resources$path[i]
countryToContinent <- read.csv(url(path_to_file)) %>%  clean_names()
print(data)
}
}
orr.sum %>%
dplyr::rename(country_name = citizenship_stable) %>%
left_join(countryToContinent) %>%
View()
View(orr)
orr.sum <- orr %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
longitude,
latitude
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
)
View(orr.sum)
orr.sum <- orr %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
citizenship_stable,
fips
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
)
orr.sum <- orr %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
# citizenship_stable,
fips
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
)
View(orr)
orr.sum <- orr %>%
filter(county_fips == ".")
orr.sum <- orr %>%
filter(county_fips != ".") %>%
mutate(refugees = as.numeric(refugees)) %>%
group_by(
# citizenship_stable,
fips
) %>%
summarise(
totalRefugees = sum(refugees, na.rm = T)
)
write_csv(orr.sum, "Desktop/refugees.csv")
library(tidyr)
library(dplyr)
library(readr)
library(httr)
library(rvest)
library(RCurl)
library(stringr)
library(jsonlite)
library(lubridate)
library(zoo)
output_path = paste('./outputs/', Sys.Date(), sep='')
dir.create(output_path, showWarnings = FALSE)
updateCaseData = function() {
source("getCases.R")
write_csv(cases__new, paste(output_path, '/cases.csv', sep=''))
write_csv(cases__new, "./outputs/latest/cases.csv")
}
checkForHospitalizationUpdate = function() {
source("getHospitalizations.R")
hospitalizations__old <- read_csv("https://www.gannett-cdn.com/delaware-online/datasets/coronavirus-tracker/latest/hospitalizations.csv") %>%
select(date_confirmed, delaware_hospitalized) %>%
mutate(date_confirmed = as.Date(date_confirmed), delaware_hospitalized = as.numeric(delaware_hospitalized)) %>%
arrange(date_confirmed)
if (hospitalizations__new$date_confirmed > tail(hospitalizations__old, 1)$date_confirmed) {
print('new entry')
hospitalizations__updated <- bind_rows(hospitalizations__old, hospitalizations__new)
} else {
hospitalizations__updated <- within(hospitalizations__old, {
delaware_hospitalized[date_confirmed == hospitalizations__new$date_confirmed] <- hospitalizations__new$delaware_hospitalized
})
print('update entry')
}
write_csv(hospitalizations__updated, paste(output_path, '/hospitalizations.csv', sep=''))
write_csv(hospitalizations__updated, "./outputs/latest/hospitalizations.csv")
}
source("getHospitalizations.R")
setwd("~/Documents/Personal/Delaware Online/2021-08-delaware-coronavirus-tracker-data-pull")
hospitalizations__old <- read_csv("https://www.gannett-cdn.com/delaware-online/datasets/coronavirus-tracker/latest/hospitalizations.csv") %>%
select(date_confirmed, delaware_hospitalized) %>%
mutate(date_confirmed = as.Date(date_confirmed), delaware_hospitalized = as.numeric(delaware_hospitalized)) %>%
arrange(date_confirmed)
View(hospitalizations__old)
hospitalizations__old <- read_csv("https://www.gannett-cdn.com/delaware-online/datasets/coronavirus-tracker/latest/hospitalizations.csv") %>%
select(date_confirmed, delaware_hospitalized) %>%
mutate(date_confirmed = as.Date(date_confirmed), delaware_hospitalized = as.numeric(delaware_hospitalized)) %>%
arrange(date_confirmed)
View(hospitalizations__old)
?stringi
?stri_rand_strings
stringi::stri_rand_strings(1, 50)
hospitalizations__old <- read_csv(paste("https://www.gannett-cdn.com/delaware-online/datasets/coronavirus-tracker/latest/hospitalizations.csv", stringi::stri_rand_strings(1, 50), sep='')) %>%
select(date_confirmed, delaware_hospitalized) %>%
mutate(date_confirmed = as.Date(date_confirmed), delaware_hospitalized = as.numeric(delaware_hospitalized)) %>%
arrange(date_confirmed)
hospitalizations__old <- read_csv(paste("https://www.gannett-cdn.com/delaware-online/datasets/coronavirus-tracker/latest/hospitalizations.csv?", stringi::stri_rand_strings(1, 50), sep='')) %>%
select(date_confirmed, delaware_hospitalized) %>%
mutate(date_confirmed = as.Date(date_confirmed), delaware_hospitalized = as.numeric(delaware_hospitalized)) %>%
arrange(date_confirmed)
View(hospitalizations__old)
